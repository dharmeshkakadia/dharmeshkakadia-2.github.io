<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <!-- mobile responsive meta -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How to write a Hive Hook</title>
  <meta name='description' content='Curious'>

<link rel="canonical" href="https://dharmeshkakadia.com/blog//hive-hook/">
  <link rel="alternate" type="application/rss+xml" title="Dharmesh Kakadia" href="/feed.xml">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@site_username">
  <meta name="twitter:creator" content="@creator_username">
  
    <meta name="twitter:title" content="How to write a Hive Hook">
  
  
    <meta name="twitter:url" content="/hive-hook/">
  
  
    <meta name="twitter:description" content="Curious">
  
  
    <meta name="twitter:image:src" content="/path/to/image/logo.png">
  

  <!-- Main Stylesheet -->
  <link href="/assets/css/main.css" rel="stylesheet">

</head>


<body>

  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44808193-2', 'auto');
  ga('send', 'pageview');
</script>
  

  <div class="container-full">
  <!-- begin header -->
  <header class="header">

    <div class="logo">
      <a class="logo__link" href="/">
      
        <img class="logo__image" src=" /images/dharmesh.png" alt="Dharmesh Kakadia">
        Dharmesh Kakadia
      
      </a>
    </div>

    <nav class="main-nav">
      <span class="main-nav__open">
        <div style="width: 30px;height: 4px;background-color: black; margin: 5px 0;"></div>
        <div style="width: 30px;height: 4px;background-color: black; margin: 5px 0;"></div>
        <div style="width: 30px;height: 4px;background-color: black; margin: 5px 0;"></div>
      </span>

      <div class="main-nav__box">
        <span class="main-nav__close">Close</span>

        <ul class="nav__list list-reset">
          <li class="nav__item">
            <a href="/" class="nav__link">Home</a>
          </li>

          <li class="nav__item">
            <a href="/about" class="nav__link">About</a>
          </li>

          <li class="nav__item">
            <a href="/words/" class="nav__link">Quotes</a>
          </li>

          <li class="nav__item">
            <a href="/book/" class="nav__link">My Book</a>
          </li>


          <li class="nav__item">
            <a href="/talks" class="nav__link">Talks</a>
          </li>
          
        </ul>

      </div>

    </nav>

  </header>
  <!-- end header -->
</div>


  <!-- begin content -->
  <main class="content" aria-label="Content">
    <div class="container">
  <!-- begin post -->
  <article class="post">
    <div class="post__head" data-aos="fade-up" data-aos-easing="ease-out-quad" data-aos-duration="700">
      <h1 class="post__title">How to write a Hive Hook</h1>
      <div class="post__date">
        <time datetime="2016-05-05T00:00:00+00:00">Published May 05, 2016</time>
      </div>
      
    </div>

    <div class="post__content" data-aos="fade-up" data-aos-easing="ease-out-quad" data-aos-delay="100" data-aos-duration="700">
      <p>Hive Hooks are little known gems that can be used for many purposes. In this post we will take a deeper look at what a Hive hook is and how to write and use a Hive hook (along with the full source code!).</p>

<h2 id="what-is-hive">What is Hive?</h2>
<p>For the readers new to <a href="https://hive.apache.org">Hive</a>, it provides an SQL interface to Hadoop. Hive can be thought of as a compiler that translates SQL (strictly speaking Hive Query Language - HQL, a variant of SQL) into a set of Mapreduce/Tez/Spark jobs. Thus, Hive is very instrumental in enabling non programmers to use Hadoop infrastructure. Traditionally, Hive had only one backend, namely MapReduce. But with recent versions, Hive supports <a href="http://spark.apache.org">Spark</a> and <a href="http://tez.apache.org">Tez</a> also as execution engines. This makes Hive a great tool for exploratory data analysis.</p>

<p>The following diagram and terms from the Hive documentation explains high level design of Hive with MapReduce backend.
<img src="https://cwiki.apache.org/confluence/download/attachments/27362072/system_architecture.png?version=1&amp;modificationDate=1414560669000&amp;api=v2" alt="Hive design diagram" /></p>

<ul>
  <li>Driver – The component which receives the queries. This component implements the notion of session handles and provides execute and fetch APIs modeled on JDBC/ODBC interfaces.</li>
  <li>Compiler – The component that parses the query, does semantic analysis on the different query blocks and query expressions and eventually generates an execution plan with the help of the table and partition metadata looked up from the metastore.</li>
  <li>Metastore – The component that stores all the structure information of the various tables and partitions in the warehouse including column and column type information, the serializers and deserializers necessary to read and write data and the corresponding HDFS files where the data is stored.</li>
  <li>Execution Engine – The component which executes the execution plan created by the compiler. The plan is a DAG of stages. The execution engine manages the dependencies between these different stages of the plan and executes these stages on the appropriate system components.</li>
</ul>

<h2 id="what-is-a-hive-hook">What is a Hive Hook?</h2>
<p>In general, Hook is a mechanism for intercepting events, messages or function calls during processing. Hive hooks are mechanism to tie into the internal working of Hive without the need of recompiling Hive. Hooks in this sense provide ability to extend and integrate external functionality with Hive. In other words Hive hooks can be used to run/inject some code during various steps of query processing. Depending on the type of hook it can be invoked at different point during query processing:</p>

<ul>
  <li>Pre-execution hooks are invoked before the execution of the query by the execution engine begins. Note that at this point you have Hive already has an optimized query plan for the execution ready.</li>
  <li>Post-execution hooks are invoked after the execution of the query is finished and before the results are returned to the user.</li>
  <li>Failure-execution hooks are invoked when the execution of the query fails.</li>
  <li>Pre-driver-run and post-driver-run hooks are invoked before and after the driver is run on the query.</li>
  <li>Pre-semantic-analyzer and Post-semantic-analyzer hooks are invoked before and after Hive runs semantic analyzer on the query string.</li>
</ul>

<h2 id="life-of-a-hive-query">Life of a Hive Query</h2>

<p>At a high level here are the steps that happen during the processing of a given query in Hive. Don’t worry if you are not familiar with some of these terms, we will discuss them later.</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">Driver.run()</code> takes the command</li>
  <li><code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.HiveDriverRunHook.preDriverRun()</code> which reads <code class="language-plaintext highlighter-rouge">hive.exec.pre.hooks</code> configuration to decide which are the pre-hooks that needs to be run.</li>
  <li><code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.Driver.compile()</code> starts processing the query by creating the abstract syntax tree (AST) representing the query.</li>
  <li><code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.parse.AbstractSemanticAnalyzerHook</code> (which implements <code class="language-plaintext highlighter-rouge">HiveSemanticAnalyzerHook</code>) calls <code class="language-plaintext highlighter-rouge">preAnalyze()</code> method.</li>
  <li>Semantic analysis is performed on the AST.</li>
  <li><code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.parse.AbstractSemanticAnalyzerHook.postAnalyze()</code> is called which executes all the configured Semantic Analyzer Hooks.</li>
  <li>Create and validate the physical query plan.</li>
  <li><code class="language-plaintext highlighter-rouge">Driver.execute()</code> is ready to run the jobs.</li>
  <li><code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.hooks.ExecuteWithHookContext.run()</code> is called to execute all the pre-execution hooks.</li>
  <li><code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.hooks.ExecDriver.execute()</code> runs all the jobs of the query.</li>
  <li>For each job <code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.stats.ClientStatsPublisher.run()</code> is called to publish statistics for the job. The interval is controlled by <code class="language-plaintext highlighter-rouge">hive.exec.counters.pull.interval</code> configuration - the default is 1000ms. The publishers to be called is decided by reading <code class="language-plaintext highlighter-rouge">hive.client.stats.publishers</code> configuration. You can also specify what counters to be published by setting <code class="language-plaintext highlighter-rouge">hive.client.stats.counters</code>.</li>
  <li>Finish all the tasks.</li>
  <li>(optional) If a task fails, call hooks configured with <code class="language-plaintext highlighter-rouge">hive.exec.failure.hooks</code>.</li>
  <li>Run post execution hooks by calling <code class="language-plaintext highlighter-rouge">ExecuteWithHookContext.run()</code> on hooks specified in <code class="language-plaintext highlighter-rouge">hive.exec.post.hooks</code>.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.HiveDriverRunHook.postDriverRun()</code> controlled by <code class="language-plaintext highlighter-rouge">hive.exec.driver.run.hooks</code>. Note that this is run after the query finishes running and before returning the results to the client.</li>
  <li>Return the result.</li>
</ol>

<h2 id="hive-hook-api">Hive Hook API</h2>

<p>There are many different kinds of Hooks that Hive supports. <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/Hook.java">Hook</a> interface is the parent of all the Hooks in Hive. It is an empty interface and has been extended by following interfaces for specific hooks:</p>

<ul>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/PreExecute.java">PreExecute</a> and <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/PostExecute.java">PostExecute</a> extends Hook interface to Pre and Post execution hooks.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/ExecuteWithHookContext.java">ExecuteWithHookContext</a> extends the Hook interface to pass on the HookContext to the hooks. <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java">HookContext</a> wraps all the information that can be used by hooks. The HookContext is passed to all the hooks that have “WithContext” in the name.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/HiveDriverRunHook.java">HiveDriverRunHook</a> extends Hook interface to run during driver phases which allows custom logic processing commands in Hive.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveSemanticAnalyzerHook.java">HiveSemanticAnalyzerHook</a> extends the Hook interface to allows plugging in custom logic for semantic analysis of the query. It has <code class="language-plaintext highlighter-rouge">preAnalyze()</code> and <code class="language-plaintext highlighter-rouge">postAnalyze()</code> methods that are executed before and after Hive performs its own semantic analysis.</li>
  <li><a href="https://github.com/apache/hive/blob/master/service/src/java/org/apache/hive/service/cli/session/HiveSessionHook.java">HiveSessionHook</a> extends Hook interface to provide session level hooks. The hook is called when a new session is started. It is configured with <code class="language-plaintext highlighter-rouge">hive.server2.session.hook</code>.</li>
  <li>Hive 1.1 added <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/Redactor.java">Query Redactor Hooks</a>. It is an abstract class that implements Hook interface that is useful for removing sensitive information about the query before putting it into job.xml. This hooks can be configured by setting <code class="language-plaintext highlighter-rouge">hive.exec.query.redactor.hooks</code> property.</li>
</ul>

<p>Hive codebase have some <a href="https://github.com/apache/hive/tree/master/ql/src/java/org/apache/hadoop/hive/ql/hooks">hook examples</a>. Right now it has following hook implementations:</p>

<ul>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/DriverTestHook.java">DriverTestHook</a> is a very simple HiveDriverRunHook that prints the command that you used to the output.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/PreExecutePrinter.java">PreExecutePrinter</a> and <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/PostExecutePrinter.java">PostExecutePrinter</a> are examples of pre and post execution hooks that prints the parameters to the output.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java">ATSHook</a> is a ExecuteWithHookContext that pushes query and plan information to <a href="https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/TimelineServer.html">YARN timeline server</a></li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/EnforceReadOnlyTables.java">EnforceReadOnlyTables</a> is a ExecuteWithHookContext that prevents modification of read-only tables.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/LineageLogger.java">LineageLogger</a> is a ExecuteWithHookContext which logs the lineage information of the query into the log file. <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/LineageInfo.java">LineageInfo</a> contains all the information about wuery lineage.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/PostExecOrcFileDump.java">PostExecOrcFileDump</a>  is a post-execution hook that prints ORC file information.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/PostExecTezSummaryPrinter.java">PostExecTezSummaryPrinter</a> is a post-execution hook that prints a summary of Tez counters.</li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/hooks/UpdateInputAccessTimeHook.java">UpdateInputAccessTimeHook</a> is a pre-execution hook that updates the access time of all the input tables before running the query.</li>
</ul>

<h2 id="writing-hive-hook">Writing Hive Hook</h2>

<p>We will now write an example Hive hook and setup it with Hive. We will write a simple pre-execution hook that will write “Hello from the hook !!”. The source code of the example is available on <a href="https://github.com/dharmeshkakadia/Hive-hook-example">github</a>.</p>

<ol>
  <li>lets setup a project using maven. Create a pom.xml in your project directory.</li>
</ol>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

    <span class="nt">&lt;groupId&gt;</span>hive-hook-example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>Hive-hook-example<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>

<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<ol>
  <li>Now add the <code class="language-plaintext highlighter-rouge">hive-exec</code> package as a dependency to your project by adding the following into your pom file.</li>
</ol>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.apache.hive<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>hive-exec<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.1.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div></div>

<ol>
  <li>Now lets create a class that implements the hook interface. We will call our class HiveExampleHook which will implement the <code class="language-plaintext highlighter-rouge">org.apache.hadoop.hive.ql.hooks.ExecuteWithHookContext</code>. This interface has only one method with following signature,</li>
</ol>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="nc">HookContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
</code></pre></div></div>

<p>For now we will just put a single statement</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello from the hook !!"</span><span class="o">);</span>
</code></pre></div></div>

<p>So, the complete class looks as follows:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.apache.hadoop.hive.ql.hooks.ExecuteWithHookContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.hive.ql.hooks.HookContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HiveExampleHook</span> <span class="kd">implements</span> <span class="nc">ExecuteWithHookContext</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="nc">HookContext</span> <span class="n">hookContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello from the hook !!"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ol>
  <li>Compile and package our hook code into a jar by issuing the following command:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn package
</code></pre></div>    </div>
    <p>This should generate a file named <code class="language-plaintext highlighter-rouge">Hive-hook-example-1.0.jar</code> in the <code class="language-plaintext highlighter-rouge">target</code> directory.</p>
  </li>
  <li>Now add the generated jar into the Hive classpath and set it as pre-execution hook. Start the Hive terminal and issue the following commands. Note that you have to
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>add jar target/Hive-hook-example-1.0.jar;
set hive.exec.pre.hooks=HiveExampleHook;
</code></pre></div>    </div>
  </li>
</ol>

<p>That’s all. We are now all set to see “Hello from hook !!” before all the Hive statements. You can check is by issuing <code class="language-plaintext highlighter-rouge">show tables;</code>. Note that the step 5 needs to be done for every Hive session (every time you start a new Hive terminal). You can make it permanent by setting the property in the hive-site.xml file.</p>

<p>If you want to see another simple Hive hook with a real use case you can check out my <a href="https://github.com/dharmeshkakadia/hive-yarn-reservation-hook">YarnReservationHook</a>. It uses Yarn’s reservation API to reserve resources for given query just before the query starts the execution via a pre-execution- hook. We have another simple post-execution-hook that cleans up the reservation at the end of query.</p>

<h2 id="metastore-hooks">Metastore Hooks</h2>

<p>Hive also has metastore specific hooks for intercepting metastore events. <a href="https://github.com/apache/hive/blob/master/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaHook.java">HiveMetaHook</a> represent the root of metastore hooks.
Metastore initialization hooks are invoked when Hive metastore is initialized. If we want to log what new tables/databases are created in Hive to external services, then Metastore hooks are the place to do it. This can be used for example to keep HBase in sync with Hive metastore. HiveMetaHook interface defines the following methods that are invoked as part of metastore transactions.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">preCreateTable</span><span class="o">(</span><span class="nc">Table</span> <span class="n">table</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MetaException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">rollbackCreateTable</span><span class="o">(</span><span class="nc">Table</span> <span class="n">table</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MetaException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">commitCreateTable</span><span class="o">(</span><span class="nc">Table</span> <span class="n">table</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MetaException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">preDropTable</span><span class="o">(</span><span class="nc">Table</span> <span class="n">table</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MetaException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">rollbackDropTable</span><span class="o">(</span><span class="nc">Table</span> <span class="n">table</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MetaException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">commitDropTable</span><span class="o">(</span><span class="nc">Table</span> <span class="n">table</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">deleteData</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MetaException</span><span class="o">;</span>
</code></pre></div></div>
<p>The <a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java">Table</a> object has all the necessary information about the Hive table being processed including its name, database it is part of, Serializer, properties, columns etc. Note that HiveMetaHook does not extend Hook interface.</p>

<p><code class="language-plaintext highlighter-rouge">hive.metastore.filter.hook</code> can be used to filter metadata results. The <a href="https://github.com/apache/hive/blob/master/metastore/src/java/org/apache/hadoop/hive/metastore/DefaultMetaStoreFilterHookImpl.java">DefaultMetaStoreFilterHookImpl</a> returns the results as is without modifying. If <code class="language-plaintext highlighter-rouge">hive.security.authorization.manager</code> is set to instance of <code class="language-plaintext highlighter-rouge">HiveAuthorizerFactory</code> then this value is ignored.</p>

<p>Also, there is <code class="language-plaintext highlighter-rouge">hive.metastore.ds.connection.url.hook</code> which allows alternative implementation for retrieving the JDO connection URL. If its value is empty (default case) the value of <code class="language-plaintext highlighter-rouge">javax.jdo.option.ConnectionURL</code> is used as the connection URL.</p>

<h2 id="caveats">Caveats</h2>
<ul>
  <li>Please note that hook instances are never re-used.</li>
  <li>Hooks are invoked in the normal processing path for Hive. So, avoid doing very costly operations in the Hive pre-hooks and metastore hooks.</li>
</ul>

<h3 id="resources">Resources:</h3>

<ol>
  <li><a href="http://stackoverflow.com/questions/17461932/hive-execution-hook">http://stackoverflow.com/questions/17461932/hive-execution-hook</a></li>
  <li><a href="http://www.slideshare.net/julingks/apache-hive-hooksminwookim130813">http://www.slideshare.net/julingks/apache-hive-hooksminwookim130813</a></li>
  <li><a href="https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/Driver.java">https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/Driver.java</a></li>
</ol>


    </div>

    

    <div class="post__share">
      <ul class="share__list list-reset">
        <li class="share__item">
          <a class="share__link share__twitter" href="https://twitter.com/intent/tweet?text=How%20to%20write%20a%20Hive%20Hook&via=dharmeshkakadia&url=/hive-hook/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" rel="nofollow">
              <svg enable-background="new 0 0 56.693 56.693" height="56.693" viewBox="0 0 56.693 56.693" width="56.693" xmlns="http://www.w3.org/2000/svg"><path d="m52.837 15.065c-1.811.805-3.76 1.348-5.805 1.591 2.088-1.25 3.689-3.23 4.444-5.592-1.953 1.159-4.115 2-6.418 2.454-1.843-1.964-4.47-3.192-7.377-3.192-5.581 0-10.106 4.525-10.106 10.107 0 .791.089 1.562.262 2.303-8.4-.422-15.848-4.445-20.833-10.56-.87 1.492-1.368 3.228-1.368 5.082 0 3.506 1.784 6.6 4.496 8.412-1.656-.053-3.215-.508-4.578-1.265-.001.042-.001.085-.001.128 0 4.896 3.484 8.98 8.108 9.91-.848.23-1.741.354-2.663.354-.652 0-1.285-.063-1.902-.182 1.287 4.015 5.019 6.938 9.441 7.019-3.459 2.711-7.816 4.327-12.552 4.327-.815 0-1.62-.048-2.411-.142 4.474 2.869 9.786 4.541 15.493 4.541 18.591 0 28.756-15.4 28.756-28.756 0-.438-.009-.875-.028-1.309 1.974-1.422 3.688-3.203 5.042-5.23z"/></svg>
            </a>
        </li>

      </ul>
    </div>


    <!-- Begin Mailchimp Signup Form -->
<!-- <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"> -->
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:24px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
     #mc_embed_signup form {text-align:center; padding:10px 0 10px 0;}
      .mc-field-group { display: inline-block; } /* positions input field horizontally */
      #mc_embed_signup input.email {font-family:'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; border: 1px solid #ABB0B2;  -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; color: #343434; background-color: #fff; box-sizing:border-box; height:32px; padding: 0px 0.4em; display: inline-block; margin: 0; width:250px; vertical-align:top;}
      #mc_embed_signup label {display:block; font-size:22px; padding-bottom:10px; font-weight:bold;}
      #mc_embed_signup .clear {display: inline-block;} /* positions button horizontally in line with input */
      #mc_embed_signup .button {font-size: 13px; border: none; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; letter-spacing: .03em; color: #fff; background-color: rgb(14, 13, 13); box-sizing:border-box; height:30px; line-height:32px; padding:0 18px; display: inline-block; margin: 0; transition: all 0.23s ease-in-out 0s;}
      #mc_embed_signup .button:hover {background-color:rgb(59, 58, 58); cursor:pointer;}
      #mc_embed_signup div#mce-responses {float:left; top:-1.4em; padding:0em .5em 0em .5em; overflow:hidden; width:90%;margin: 0 5%; clear: both;}
      #mc_embed_signup div.response {margin:1em 0; padding:1em .5em .5em 0; font-weight:bold; float:left; top:-1.5em; z-index:1; width:80%;}
      #mc_embed_signup #mce-error-response {display:none;}
      #mc_embed_signup #mce-success-response {color:#529214; display:none;}
      #mc_embed_signup label.error {display:block; float:none; width:auto; margin-left:1.05em; text-align:left; padding:.5em 0;}
      @media (max-width: 768px) {
          #mc_embed_signup input.email {width:100%; margin-bottom:5px;}
          #mc_embed_signup .clear {display: block; width: 100% }
          #mc_embed_signup .button {width: 100%; margin:0; }
      }
</style>
<div id="mc_embed_signup">
<form action="https://world.us12.list-manage.com/subscribe/post?u=726520195d8ffab18dde3b5d8&amp;id=f2a783d3df" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Subscribe to get my latest post</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="your email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_726520195d8ffab18dde3b5d8_f2a783d3df" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>


<!--End mc_embed_signup-->

    <div class="post__navigation">
      
      <a class="prev" href="/old-blog/">
        <div class="prev__post-icon">
          <svg enable-background="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m352 128.4-32.3-32.4-159.7 160 159.7 160 32.3-32.4-127.3-127.6z"/></svg>
        </div>
        <span class="post__nav-wrapper">
          <div class="post__nav-image" style="background-image: url()"></div>
          <h2 class="post__nav-title"><time datetime="2016-05-05T00:00:00+00:00">May 05, 2016</time> <br>Link to my old blog</h2>
        </span>
      </a>
      

      
      <a class="next" href="/SEDaily-Podcast/">
        <div class="next__post-icon">
          <svg enable-background="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m160 128.4 32.3-32.4 159.7 160-159.7 160-32.3-32.4 127.3-127.6z"/></svg>
        </div>
        <span class="post__nav-wrapper">
          <div class="post__nav-image" style="background-image: url()"></div>
          <h2 class="post__nav-title"><time datetime="2016-05-05T00:00:00+00:00">May 05, 2016</time> <br>Mesos Podcast with SEDaily</h2>
        </span>
      </a>
      
    </div>

    

  </article>
  <!-- end post -->
</div>

  </main>
  <!-- end content -->

  <div class="container">
  <!-- begin footer -->
  <footer class="footer">
    <div class="footer__inner">
      <div class="contact">
        <div class="contact__title">Have a question where I can help? <a href="mailto:dharmesh.kakadia@gmail.com">Email me</a></div>
        <ul class="contact__list list-reset">
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://twitter.com/dharmeshkakadia">Twitter</a>
          </li>
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://facebook.com/dharmesh.kakadia">Facebook</a>
          </li>
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://github.com/dharmeshkakadia">Github</a>
          </li>
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://instagram.com/dharmeshkakadia">LinkedIn</a>
          </li>
          
        </ul>
      </div>
    </div>
  </footer>
  <!-- end footer -->
</div>


  <!-- begin js -->
  <script src="/assets/js/vendors/jquery-3.3.1.min.js"></script>
  <script src="/assets/js/vendors/aos.js"></script>
  <script src="/assets/js/vendors/jquery.fitvids.js"></script>
  <script src="/assets/js/common.js"></script>
  <!-- end js -->
</body>

</html>
