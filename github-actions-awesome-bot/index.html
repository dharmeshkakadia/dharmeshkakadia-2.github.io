<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <!-- mobile responsive meta -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Verifying links with Github actions & Awesome Bot</title>
  <meta name='description' content='Curious'>


  <link rel="alternate" type="application/rss+xml" title="Dharmesh Kakadia" href="/feed.xml">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@site_username">
  <meta name="twitter:creator" content="@creator_username">
  
    <link rel="canonical" href="https://dharmeshkakadia.com/blog/github-actions-awesome-bot/">
    <meta http-equiv="refresh" content="0; url=https://dharmeshkakadia.com/blog/github-actions-awesome-bot/">
  
  
  
  
  
    <meta name="twitter:title" content="Verifying links with Github actions & Awesome Bot">
  
  
    <meta name="twitter:url" content="/github-actions-awesome-bot/">
  
  
    <meta name="twitter:description" content="Curious">
  
  
    <meta name="twitter:image:src" content="/path/to/image/logo.png">
  

  <!-- Main Stylesheet -->
  <link href="/assets/css/main.css" rel="stylesheet">

</head>


<body>

  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44808193-2', 'auto');
  ga('send', 'pageview');
</script>
  

  <div class="container-full">
  <!-- begin header -->
  <header class="header">

    <div class="logo">
      <a class="logo__link" href="/">
      
        <img class="logo__image" src=" /images/dharmesh.png" alt="Dharmesh Kakadia">
        Dharmesh Kakadia
      
      </a>
    </div>

    <nav class="main-nav">
      <span class="main-nav__open">
        <div style="width: 30px;height: 4px;background-color: black; margin: 5px 0;"></div>
        <div style="width: 30px;height: 4px;background-color: black; margin: 5px 0;"></div>
        <div style="width: 30px;height: 4px;background-color: black; margin: 5px 0;"></div>
      </span>

      <div class="main-nav__box">
        <span class="main-nav__close">Close</span>

        <ul class="nav__list list-reset">
          <li class="nav__item">
            <a href="/" class="nav__link">Home</a>
          </li>

          <li class="nav__item">
            <a href="/about" class="nav__link">About</a>
          </li>

          <li class="nav__item">
            <a href="/words/" class="nav__link">Quotes</a>
          </li>

          <li class="nav__item">
            <a href="/book/" class="nav__link">My Book</a>
          </li>


          <li class="nav__item">
            <a href="/talks" class="nav__link">Talks</a>
          </li>
          
        </ul>

      </div>

    </nav>

  </header>
  <!-- end header -->
</div>


  <!-- begin content -->
  <main class="content" aria-label="Content">
    <div class="container">
  <!-- begin post -->
  <article class="post">
    <div class="post__head" data-aos="fade-up" data-aos-easing="ease-out-quad" data-aos-duration="700">
      <h1 class="post__title">Verifying links with Github actions &amp; Awesome Bot</h1>
      <div class="post__date">
        <time datetime="2019-12-27T00:00:00+00:00">Published Dec 27, 2019</time>
      </div>
      
    </div>

    <div class="post__content" data-aos="fade-up" data-aos-easing="ease-out-quad" data-aos-delay="100" data-aos-duration="700">
      <p>Recently I started using <a href="https://github.com/features/actions">github action</a> to automate link checking in all of <a href="https://github.com/dharmeshkakadia?utf8=%E2%9C%93&amp;tab=repositories&amp;q=awesome&amp;type=&amp;language=">my awesome repos</a>. I have been using <a href="https://github.com/dkhamsing/awesome_bot">awesome_bot</a> to validate links and checks for duplicates, with <a href="https://travis-ci.org/">travis</a> since past 2+ years. I decided to give github actions try with this very simple automation. Github action is very rich and can automate a lot of chores for developers. There are number of existing actions available in the <a href="https://github.com/marketplace?type=actions">github market place</a>. However, I couldn’t find one that allows me to verify links in markdown. So lets build one from <a href="https://github.com/dharmeshkakadia/awesome-mesos/pull/45">scratch</a>!</p>

<p>Here is my github action config : </p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">CI</span>

<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>

    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>

    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v1</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">docker://dkhamsing/awesome_bot:latest</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">args</span><span class="pi">:</span> <span class="s">--allow-redirect /github/workspace/README.md</span>
</code></pre></div></div>

<p>You can put this under <code class="language-plaintext highlighter-rouge">.github/workflows/main.yaml</code> in your repo and voila!</p>

<p>Now let’s go through the file to understand whats going on here. <code class="language-plaintext highlighter-rouge">name</code> is just a display name used. <code class="language-plaintext highlighter-rouge">on</code> specifies when this workflow runs. There are number of <a href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/events-that-trigger-workflows">options available</a>, but here we just need to run it on every <code class="language-plaintext highlighter-rouge">push</code>. We can filter which branches this triggers work etc. However we don’t need them for this. Just know that <a href="https://help.github.com/en/actions/automating-your-workflow-with-github-actions/workflow-syntax-for-github-actions">Github actions syntax</a> is very flexible.</p>

<p><code class="language-plaintext highlighter-rouge">jobs</code> is where the meat of the workflow is. Here you can specify what you actually want to do as part of this workflow. In our workflow we only have job with <code class="language-plaintext highlighter-rouge">job_id</code> as <code class="language-plaintext highlighter-rouge">build</code>. If we specify more jobs it by default runs in parallel, but we can create dependency chains using <code class="language-plaintext highlighter-rouge">jobs.&lt;job_id&gt;.needs</code> tag. We are specifying that the job should run on <code class="language-plaintext highlighter-rouge">ubuntu-latest</code> agent. We need to use ubuntu agent when running a docker image with github action.</p>

<p>Now a job consists of a multiple tasks called <code class="language-plaintext highlighter-rouge">steps</code>. Here we are using two steps. First a github provided action called <code class="language-plaintext highlighter-rouge">actions/checkout@v1</code> to checkout the code. Second we are specifying a docker action with <code class="language-plaintext highlighter-rouge">dkhamsing/awesome_bot:latest</code> docker image. This is the docker image recommended by <a href="https://github.com/dkhamsing/awesome_bot#docker-examples">awesome_bot repo</a>. We are specifying here that awesome_bot should respect redirects and specifying the file path for our markdown file. Note that the checkout code is mapped as <code class="language-plaintext highlighter-rouge">/github/workspace/</code> while running with docker. This bit of information wasn’t easy to find out and took few iteration to get right. That’s it!</p>

<p>You are all set now. All the PRs will now automatically run awesome bot to check the links and validation results will be visible on the PR page itself! You can look at <a href="https://github.com/dharmeshkakadia/awesome-mesos/pull/46">some pull requests</a> if you want example - click on green checkmark on right and then on <code class="language-plaintext highlighter-rouge">Details</code> next to <code class="language-plaintext highlighter-rouge">CI/build (push)</code> and you will see the full logs of validation under <code class="language-plaintext highlighter-rouge">actions</code> tab in the repository.</p>

<p><img src="/images/github-actions-logs.png" alt="Github actions logs" /></p>

<p>Happy hacking and happy holidays everyone !</p>

    </div>

    

    <div class="post__share">
      <ul class="share__list list-reset">
        <li class="share__item">
          <a class="share__link share__twitter" href="https://twitter.com/intent/tweet?text=Verifying%20links%20with%20Github%20actions%20&%20Awesome%20Bot&via=dharmeshkakadia&url=/github-actions-awesome-bot/"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" rel="nofollow">
              <svg enable-background="new 0 0 56.693 56.693" height="56.693" viewBox="0 0 56.693 56.693" width="56.693" xmlns="http://www.w3.org/2000/svg"><path d="m52.837 15.065c-1.811.805-3.76 1.348-5.805 1.591 2.088-1.25 3.689-3.23 4.444-5.592-1.953 1.159-4.115 2-6.418 2.454-1.843-1.964-4.47-3.192-7.377-3.192-5.581 0-10.106 4.525-10.106 10.107 0 .791.089 1.562.262 2.303-8.4-.422-15.848-4.445-20.833-10.56-.87 1.492-1.368 3.228-1.368 5.082 0 3.506 1.784 6.6 4.496 8.412-1.656-.053-3.215-.508-4.578-1.265-.001.042-.001.085-.001.128 0 4.896 3.484 8.98 8.108 9.91-.848.23-1.741.354-2.663.354-.652 0-1.285-.063-1.902-.182 1.287 4.015 5.019 6.938 9.441 7.019-3.459 2.711-7.816 4.327-12.552 4.327-.815 0-1.62-.048-2.411-.142 4.474 2.869 9.786 4.541 15.493 4.541 18.591 0 28.756-15.4 28.756-28.756 0-.438-.009-.875-.028-1.309 1.974-1.422 3.688-3.203 5.042-5.23z"/></svg>
            </a>
        </li>

      </ul>
    </div>


    <!-- Begin Mailchimp Signup Form -->
<!-- <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"> -->
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:24px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
     #mc_embed_signup form {text-align:center; padding:10px 0 10px 0;}
      .mc-field-group { display: inline-block; } /* positions input field horizontally */
      #mc_embed_signup input.email {font-family:'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; border: 1px solid #ABB0B2;  -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; color: #343434; background-color: #fff; box-sizing:border-box; height:32px; padding: 0px 0.4em; display: inline-block; margin: 0; width:250px; vertical-align:top;}
      #mc_embed_signup label {display:block; font-size:22px; padding-bottom:10px; font-weight:bold;}
      #mc_embed_signup .clear {display: inline-block;} /* positions button horizontally in line with input */
      #mc_embed_signup .button {font-size: 13px; border: none; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; letter-spacing: .03em; color: #fff; background-color: rgb(14, 13, 13); box-sizing:border-box; height:30px; line-height:32px; padding:0 18px; display: inline-block; margin: 0; transition: all 0.23s ease-in-out 0s;}
      #mc_embed_signup .button:hover {background-color:rgb(59, 58, 58); cursor:pointer;}
      #mc_embed_signup div#mce-responses {float:left; top:-1.4em; padding:0em .5em 0em .5em; overflow:hidden; width:90%;margin: 0 5%; clear: both;}
      #mc_embed_signup div.response {margin:1em 0; padding:1em .5em .5em 0; font-weight:bold; float:left; top:-1.5em; z-index:1; width:80%;}
      #mc_embed_signup #mce-error-response {display:none;}
      #mc_embed_signup #mce-success-response {color:#529214; display:none;}
      #mc_embed_signup label.error {display:block; float:none; width:auto; margin-left:1.05em; text-align:left; padding:.5em 0;}
      @media (max-width: 768px) {
          #mc_embed_signup input.email {width:100%; margin-bottom:5px;}
          #mc_embed_signup .clear {display: block; width: 100% }
          #mc_embed_signup .button {width: 100%; margin:0; }
      }
</style>
<div id="mc_embed_signup">
<form action="https://world.us12.list-manage.com/subscribe/post?u=726520195d8ffab18dde3b5d8&amp;id=f2a783d3df" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Subscribe to get my latest post</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="your email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_726520195d8ffab18dde3b5d8_f2a783d3df" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>


<!--End mc_embed_signup-->

    <div class="post__navigation">
      
      <a class="prev" href="/rstudio-k8s/">
        <div class="prev__post-icon">
          <svg enable-background="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m352 128.4-32.3-32.4-159.7 160 159.7 160 32.3-32.4-127.3-127.6z"/></svg>
        </div>
        <span class="post__nav-wrapper">
          <div class="post__nav-image" style="background-image: url()"></div>
          <h2 class="post__nav-title"><time datetime="2019-12-27T00:00:00+00:00">Dec 27, 2019</time> <br>Versatile RStudio development environment on Kubernetes</h2>
        </span>
      </a>
      

      
      <a class="next" href="/spark-parser-internals/">
        <div class="next__post-icon">
          <svg enable-background="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m160 128.4 32.3-32.4 159.7 160-159.7 160-32.3-32.4 127.3-127.6z"/></svg>
        </div>
        <span class="post__nav-wrapper">
          <div class="post__nav-image" style="background-image: url()"></div>
          <h2 class="post__nav-title"><time datetime="2019-12-27T00:00:00+00:00">Dec 27, 2019</time> <br>Internals of Spark Parser</h2>
        </span>
      </a>
      
    </div>

    

  </article>
  <!-- end post -->
</div>

  </main>
  <!-- end content -->

  <div class="container">
  <!-- begin footer -->
  <footer class="footer">
    <div class="footer__inner">
      <div class="contact">
        <div class="contact__title">Have a question where I can help? <a href="mailto:dharmesh.kakadia@gmail.com">Email me</a></div>
        <ul class="contact__list list-reset">
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://twitter.com/dharmeshkakadia">Twitter</a>
          </li>
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://facebook.com/dharmesh.kakadia">Facebook</a>
          </li>
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://github.com/dharmeshkakadia">Github</a>
          </li>
          
          <li class="contact__item">
            <a class="contact__link" rel="me" href="https://instagram.com/dharmeshkakadia">LinkedIn</a>
          </li>
          
        </ul>
      </div>
    </div>
  </footer>
  <!-- end footer -->
</div>


  <!-- begin js -->
  <script src="/assets/js/vendors/jquery-3.3.1.min.js"></script>
  <script src="/assets/js/vendors/aos.js"></script>
  <script src="/assets/js/vendors/jquery.fitvids.js"></script>
  <script src="/assets/js/common.js"></script>
  <!-- end js -->
</body>

</html>
